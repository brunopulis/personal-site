{%- set defaultVariant = variant or 'default' -%}
{%- set defaultEmail = email or 'brunopulis@protonmail.com' -%}
{%- set subject = ('Re: ' + postTitle) | urlencode -%}
{%- set bodyText = 'Olá! Li seu post "' + postTitle + '" e gostaria de comentar:\n\n' + postUrl + '\n\n' -%}
{%- set body = bodyText | urlencode -%}
{%- set mailToLink = 'mailto:' + defaultEmail + '?subject=' + subject + '&body=' + body -%}


<div class="share-buttons py-4 border-t border-gray-200">
  <p class="text-sm font-semibold text-blood-red-800">Compartilhe este artigo:</p>
  
  <ul class="flex flex-wrap gap-3 my-6 rounded-lg border border-gray-200 bg-gray-50 p-4 text-sm">
    <li>
      <a href="{{ mailToLink }}" class="inline-flex items-center gap-2 rounded-lg font-semibold text-blood-red-800 underline hover:text-blood-red-900">
        Responder por e-mail
      </a>
    </li>
    <li>
      <a href="https://twitter.com/intent/tweet?url={{ meta.url }}{{ page.url }}&text={{ title | urlencode }}&via=brunopulis" 
          target="_blank"
          rel="noopener noreferrer"
          class="inline-flex items-center gap-2 rounded-lg font-semibold text-blood-red-800 underline hover:text-blood-red-900">
        Twitter
      </a>
    </li>
    <li>
      <a  href="https://www.linkedin.com/sharing/share-offsite/?url={{ meta.url }}{{ page.url }}"
          target="_blank"
          rel="noopener noreferrer"
          class="inline-flex items-center gap-2 rounded-lg font-semibold text-blood-red-800 underline hover:text-blood-red-900">
        LinkedIn
      </a>
    </li>
    <li>
      <a 
      href="https://www.facebook.com/sharer/sharer.php?u={{ meta.url }}{{ page.url }}"
      target="_blank"
      rel="noopener noreferrer"
      class="inline-flex items-center gap-2 rounded-lg font-semibold text-blood-red-800 underline hover:text-blood-red-900">
      Facebook
    </a>
    </li>
    <li>
      <a 
      href="https://bsky.app/intent/compose?text={{ title | urlencode }}%0A{{ meta.url }}{{ page.url }}"
      target="_blank"
      rel="noopener noreferrer"
      class="inline-flex items-center gap-2 rounded-lg font-semibold text-blood-red-800 underline hover:text-blood-red-900">
      Bluesky
      </a>
    </li>
    <li>
      <a 
        href="https://toot.kytta.dev/?text={{ title | urlencode }}%0A{{ meta.url }}{{ page.url }}"
        target="_blank"
        rel="noopener noreferrer"
        class="inline-flex items-center gap-2 rounded-lg font-semibold text-blood-red-800 underline hover:text-blood-red-900">
        Mastodon
      </a>
    </li>
    <li>
      <button  
        id="copy-link"
        class="inline-flex items-center gap-2 rounded-lg font-semibold text-blood-red-800 underline hover:text-blood-red-900"
        data-url="{{ meta.url }}{{ page.url }}">
        <span id="copy-text">Copiar link</span>
      </button>
    </li>
  </ul>
</div>

<script>
  document.addEventListener('DOMContentLoaded', () => {
  const copyButton = document.getElementById('copy-link');
  
  if (!copyButton) return;

  copyButton.addEventListener('click', async () => {
    const url = copyButton.dataset.url;
    const originalText = document.getElementById('copy-text').textContent;

    try {
      // Tenta usar a API Clipboard (moderna)
      if (navigator.clipboard) {
        await navigator.clipboard.writeText(url);
      } else {
        // Fallback para navegadores antigos
        const textArea = document.createElement('textarea');
        textArea.value = url;
        document.body.appendChild(textArea);
        textArea.select();
        document.execCommand('copy');
        document.body.removeChild(textArea);
      }

      // Feedback visual
      const copyText = document.getElementById('copy-text');
      copyText.textContent = '✓ Copiado!';
      
      setTimeout(() => {
        copyText.textContent = originalText;
      }, 2000);
    } catch (error) {
      console.error('Erro ao copiar:', error);
      alert('Erro ao copiar link');
    }
  });
});
</script>