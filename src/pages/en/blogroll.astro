---
import { ExternalLink } from '@lucide/astro';
import { getCollection } from 'astro:content';
const blogroll = await getCollection('blogroll');
const grouped = blogroll.reduce((acc, item) => {
  const cat = item.data.category || 'Outros';
  acc[cat] = acc[cat] || [];
  acc[cat].push(item);
  return acc;
}, {});

import HeroSection from '@components/layouts/HeroSection.astro';
import Layout from '@layout/Layout.astro';
---

<Layout title="Blogroll - Bruno Pulis">
  <main id="main-content">
    <HeroSection title="Blogroll" description="Blogs que valem a pena dar uma olhada" />

    <section class="bg-white">
      <div class="container-custom py-8">
        <article>
          <div class="container">
            {
              Object.entries(grouped).map(([category, items]) => (
                <div>
                  <h2 class="text-2xl font-bold mt-8 mb-4 capitalize">{category}</h2>

                  <div class="grid gap-6 sm:grid-cols-2 md:grid-cols-3">
                    {items.map((i) => (
                      <article class="p-4 border rounded-lg shadow-sm bg-white">
                        <h3 class="text-lg font-semibold mb-2">{i.data.title}</h3>
                        <p class="text-gray-700 mb-3">{i.data.description}</p>

                        <ul class="flex gap-3 text-sm">
                          {i.data.rss_feed && (
                            <li>
                              <a
                                href={i.data.rss_feed}
                                target="_blank"
                                rel="noopener noreferrer"
                                class="text-blood-red-800 inline-flex items-center gap-2 font-semibold underline underline-offset-8"
                              >
                                RSS
                                <ExternalLink class="h-4 w-4" aria-hidden="true" />
                              </a>
                            </li>
                          )}

                          <li class="ml-2 inline-flex">
                            <a
                              href={i.data.url}
                              target="_blank"
                              rel="noopener noreferrer"
                              class="text-blood-red-800 inline-flex items-center gap-2 font-semibold underline underline-offset-8"
                            >
                              Site
                              <ExternalLink class="h-4 w-4" aria-hidden="true" />
                            </a>
                          </li>
                        </ul>
                      </article>
                    ))}
                  </div>
                </div>
              ))
            }
          </div>
        </article>
      </div>
    </section>
  </main>
</Layout>
