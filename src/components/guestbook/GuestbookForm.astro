---
---

<form id="guestbook-form" class="space-y-4">
  <input
    type="text"
    id="name"
    placeholder="Seu nome"
    class="w-full p-2 border rounded-md"
    required
  />
  <textarea
    id="message"
    placeholder="Deixe sua mensagem..."
    class="w-full p-2 border rounded-md"
    required
  ></textarea>
  <button
    type="submit"
    class="bg-blue-600 text-white px-4 py-2 rounded-md hover:bg-blue-700 transition"
  >
    Enviar
  </button>
</form>

<script>
  const form = document.getElementById('guestbook-form')

  form.addEventListener('submit', async (e) => {
    e.preventDefault()
    const name = form.name.value.trim()
    const message = form.message.value.trim()
    if (!name || !message) return

    const res = await fetch('/.netlify/functions/add-message', {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify({ name, message })
    })

    if (res.ok) {
      form.reset()
      document.dispatchEvent(new CustomEvent('guestbookUpdated'))
    } else {
      alert('Erro ao enviar mensagem ðŸ˜¢')
    }
  })
</script>
