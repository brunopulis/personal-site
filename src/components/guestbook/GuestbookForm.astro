<form class="space-y-4" id="guestbook-form">
  <input type="text" id="name" placeholder="Seu nome" class="w-full rounded-md border p-2" required />
  <textarea id="message" placeholder="Deixe sua mensagem..." class="w-full rounded-md border p-2" required></textarea>
  <button type="submit" class="rounded-md bg-blue-600 px-4 py-2 text-white transition hover:bg-blue-700">
    Enviar
  </button>
</form>

<script>
  const form = document.getElementById('guestbook-form')

  form.addEventListener('submit', async (e) => {
    e.preventDefault()
    const name = form.name.value.trim()
    const message = form.message.value.trim()
    if (!name || !message) return

    const res = await fetch('/.netlify/functions/add-message', {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify({ name, message }),
    })

    if (res.ok) {
      form.reset()
      document.dispatchEvent(new CustomEvent('guestbookUpdated'))
    } else {
      alert('Erro ao enviar mensagem ðŸ˜¢')
    }
  })
</script>
