---
// Calculator.astro
const pricePerPage = 100;
---

<section id="calculator" class="bg-gray-50 py-20">
  <div class="container mx-auto px-4">
    <div class="mb-12 text-center">
      <h2 class="mb-4 text-3xl font-bold text-gray-800 md:text-4xl">Calcule o Valor do Serviço</h2>
      <p class="mx-auto max-w-3xl text-xl text-gray-600">
        Forneça a quantidade de páginas do seu documento para receber um orçamento instantâneo. Cobramos uma taxa fixa
        de R$ 50 por página.
      </p>
    </div>

    <div class="mx-auto max-w-4xl">
      <div class="overflow-hidden rounded-xl bg-white shadow-xl">
        <div class="flex flex-col md:flex-row">
          <div class="bg-gradient-to-br from-blue-800 to-teal-700 p-8 text-white md:w-1/2">
            <div class="mb-6 flex items-center">
              <svg class="mr-3 h-8 w-8" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M9 7h6m0 10v-3m-3 3h.01M9 17h.01M9 14h.01M12 14h.01M15 11h.01M12 11h.01M9 11h.01M7 21h10a2 2 0 002-2V5a2 2 0 00-2-2H7a2 2 0 00-2 2v14a2 2 0 002 2z"
                ></path>
              </svg>
              <h3 class="text-2xl font-bold">Calculadora de Orçamento</h3>
            </div>
            <p class="mb-6">
              Nossa calculadora ajuda você a estimar o custo para tornar seus documentos acessíveis. O preço é fixo em
              R$ 50 por página, independente da complexidade.
            </p>
            <div class="rounded-lg bg-white/10 p-6 backdrop-blur-sm">
              <div class="flex flex-col space-y-4">
                <div class="flex items-center justify-between">
                  <span class="text-lg">Preço por página:</span>
                  <span class="text-xl font-semibold">R$ {pricePerPage.toFixed(2)}</span>
                </div>
                <div class="flex items-center justify-between">
                  <span class="text-lg">Número de páginas:</span>
                  <span id="display-pages" class="text-xl font-semibold">1</span>
                </div>
                <div class="my-2 h-px bg-white/20"></div>
                <div class="flex items-center justify-between">
                  <span class="text-lg font-bold">Valor total:</span>
                  <span id="display-total" class="text-2xl font-bold">R$ 50.00</span>
                </div>
              </div>
            </div>
          </div>

          <div class="p-8 md:w-1/2">
            <h3 class="mb-6 text-2xl font-bold text-gray-800">Insira os Detalhes do Documento</h3>

            <div class="mb-6">
              <label for="pageCount" class="mb-2 block font-medium text-gray-700"> Quantidade de Páginas </label>
              <div class="flex items-center">
                <button
                  id="decrement-btn"
                  class="flex h-12 w-12 items-center justify-center rounded-l-lg bg-gray-200 text-gray-800 transition-colors hover:bg-gray-300"
                  aria-label="Diminuir quantidade"
                >
                  <svg class="h-5 w-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20 12H4"></path>
                  </svg>
                </button>
                <input
                  type="number"
                  id="pageCount"
                  value="1"
                  min="1"
                  class="h-12 w-full border-y border-gray-300 text-center text-xl focus:ring-2 focus:ring-teal-500 focus:outline-none"
                  aria-label="Quantidade de páginas"
                />
                <button
                  id="increment-btn"
                  class="flex h-12 w-12 items-center justify-center rounded-r-lg bg-gray-200 text-gray-800 transition-colors hover:bg-gray-300"
                  aria-label="Aumentar quantidade"
                >
                  <svg class="h-5 w-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6v6m0 0v6m0-6h6m-6 0H6"
                    ></path>
                  </svg>
                </button>
              </div>
            </div>

            <div class="mb-6 rounded-lg border border-teal-100 bg-teal-50 p-6">
              <h4 class="mb-2 flex items-center font-bold text-teal-800">
                <svg class="mr-1 h-5 w-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path
                    stroke-linecap="round"
                    stroke-linejoin="round"
                    stroke-width="2"
                    d="M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1"
                  ></path>
                </svg>
                Orçamento Estimado
              </h4>
              <p class="text-teal-700">
                Para um documento com <span id="estimate-pages" class="font-bold">1 página</span>, o valor total será de <span
                  id="estimate-total"
                  class="font-bold">R$ 50.00</span
                >.
              </p>
            </div>

            <div class="text-center">
              <a
                href="#contact"
                class="inline-block w-full rounded-md bg-teal-600 px-6 py-3 font-medium text-white transition-colors duration-300 hover:bg-teal-700 md:w-auto"
              >
                Solicitar Orçamento Detalhado
              </a>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</section>

<script>
  const pricePerPage = 100
  let pageCount = 1

  // Elementos do DOM
  const pageCountInput = document.getElementById('pageCount') as HTMLInputElement
  const decrementBtn = document.getElementById('decrement-btn')
  const incrementBtn = document.getElementById('increment-btn')
  const displayPages = document.getElementById('display-pages')
  const displayTotal = document.getElementById('display-total')
  const estimatePages = document.getElementById('estimate-pages')
  const estimateTotal = document.getElementById('estimate-total')

  // Função para atualizar o display
  function updateDisplay() {
    const totalPrice = pageCount * pricePerPage

    if (displayPages) displayPages.textContent = pageCount.toString()
    if (displayTotal) displayTotal.textContent = `R$ ${totalPrice.toFixed(2)}`
    if (estimatePages) {
      estimatePages.textContent = `${pageCount} página${pageCount !== 1 ? 's' : ''}`
    }
    if (estimateTotal) estimateTotal.textContent = `R$ ${totalPrice.toFixed(2)}`

    if (pageCountInput) pageCountInput.value = pageCount.toString()
  }

  // Event listeners
  if (decrementBtn) {
    decrementBtn.addEventListener('click', () => {
      if (pageCount > 1) {
        pageCount--
        updateDisplay()
      }
    })
  }

  if (incrementBtn) {
    incrementBtn.addEventListener('click', () => {
      pageCount++
      updateDisplay()
    })
  }

  if (pageCountInput) {
    pageCountInput.addEventListener('input', (e) => {
      const target = e.target as HTMLInputElement
      const value = parseInt(target.value, 10)

      if (!isNaN(value) && value > 0) {
        pageCount = value
        updateDisplay()
      } else if (target.value === '') {
        pageCount = 0
        updateDisplay()
      }
    })

    pageCountInput.addEventListener('blur', () => {
      if (pageCount <= 0) {
        pageCount = 1
        updateDisplay()
      }
    })
  }

  // Inicialização
  updateDisplay()
</script>
