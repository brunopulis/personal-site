---
import { getCollection } from 'astro:content';

interface Props {
  sort?: 'newest' | 'oldest';
}

const { sort = 'newest' } = Astro.props;

// Buscar fotos da collection
let allPhotos = await getCollection('photos');

// Ordenar
if (sort === 'newest') {
  allPhotos = allPhotos.sort(
    (a, b) => new Date(b.data.date).getTime() - new Date(a.data.date).getTime()
  );
} else {
  allPhotos = allPhotos.sort(
    (a, b) => new Date(a.data.date).getTime() - new Date(b.data.date).getTime()
  );
}

// Formatar dados
const galleryPhotos = allPhotos.map((photo) => ({
  id: photo.data.id,
  slug: photo.slug,
  thumb: photo.data.thumb,
  alt: photo.data.alt,
  title: photo.data.title,
}));
---

<div class="grid">
  {
    galleryPhotos.map((photo) => (
      <img
        src={photo.thumb}
        alt={photo.alt}
        class="w-full h-full object-cover group-hover:scale-105 transition-transform duration-300"
        loading="lazy"
      />
    ))
  }
</div>

<style>
  /* Fallback para navegadores que n√£o suportam @supports */
  @media (hover: hover) {
    a.group:hover img {
      transform: scale(1.05);
    }
  }
</style>
