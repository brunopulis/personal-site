---
import { Image } from 'astro:assets'
import pulisLogo from '@/assets/horizontal/blood.svg'
import { Menu, X } from '@lucide/astro'
import SkipLink from '@/components/utils/SkipLink.astro'

const { pathname } = Astro.url
---

<div class="bg-errie-black-900 py-3 text-center text-white" style="font-size: .85rem;">
  Este site está sendo refatorado. Se algo parecer quebrado é por esse motivo.
</div>

<header x-data="{ open: false }" class="w-full bg-white/90 py-4 backdrop-blur-xs transition-colors duration-300">
  <SkipLink />
  <div class="container-custom flex items-center justify-between">
    <div class="flex-shrink-0">
      <a href="/" class="" aria-label="Ir para página inicial">
        <Image src={pulisLogo} class="h6- w-auto" alt="Bruno Pulis" loading="eager" />
      </a>
    </div>
    <nav class="hidden items-center space-x-8 md:flex" aria-label="Navegação principal">
      <ul class="space-x-5 text-lg font-medium md:flex">
        <li class="main-nav__item">
          <a
            href="/sobre"
            class={`transition-colors font-medium focus:outline-2 rounded-sm px-1 py-1 text-errie-black-900  hover:text-blood-red-800 underline-offset-8 hover:underline ${
              pathname === '/sobre'
                ? ' text-blood-red focus:ring-blood-red-800  hover:text-blood-red-800 transition-colors--active'
                : ''
            }`}>Sobre</a
          >
        </li>
        <li class="main-nav__item">
          <a
            href="/projetos"
            class={`transition-colors font-medium focus:outline-2 rounded-sm px-1 py-1 text-errie-black-900 hover:text-blood-red-800 underline-offset-8 hover:underline   ${
              pathname === '/projetos'
                ? ' text-blood-red focus:ring-blood-red-800  hover:text-blood-red-800 transition-colors--active'
                : ''
            }`}>Projetos</a
          >
        </li>
        <li class="main-nav__item">
          <a
            href="/servicos"
            class={`text-errie-black-900 hover:text-blood-red-800 underline-offset-8 hover:underline font-medium transition-colors${
              pathname === '/servicos'
                ? ' text-errie-black-900 hover:text-blood-red-800 font-medium transition-colors--active'
                : ''
            }`}>Serviços</a
          >
        </li>
        <li class="main-nav__item">
          <a
            href="/blog"
            class={`text-errie-black-900 hover:text-blood-red-800 underline-offset-8 hover:underline font-medium transition-colors${
              pathname === '/blog'
                ? ' text-errie-black-900 hover:text-blood-red-800 font-medium transition-colors--active'
                : ''
            }`}>Blog</a
          >
        </li>
        <li class="main-nav__item">
          <a
            href="/newsletter"
            class={`text-errie-black-900 hover:text-blood-red-800 underline-offset-8 hover:underline font-medium transition-colors${
              pathname === '/newsletter'
                ? ' text-errie-black-900 hover:text-blood-red-800font-medium transition-colors--active'
                : ''
            }`}>Newsletter</a
          >
        </li>
        <li class="main-nav__item">
          <a
            href="/contato"
            class={`transition-colors font-medium focus:outline-2 rounded-sm px-1 py-1 text-errie-black-900 hover:text-blood-red-800 underline-offset-8 hover:underline  ${
              pathname === '/contato'
                ? ' text-errie-black-900 hover:text-blood-red-800 font-medium transition-colors--active'
                : ''
            }`}>Contato</a
          >
        </li>
      </ul>
    </nav>

    <div class="md:hidden">
      <button
        @click="open = !open"
        :aria-expanded="open"
        aria-controls="mobile-menu"
        aria-label="Abrir menu"
        class="focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50 inline-flex size-9 shrink-0 items-center justify-center gap-2 rounded-md text-sm font-medium whitespace-nowrap transition-all outline-none focus:ring-2 focus:ring-[var(--color-burgundy)] focus:ring-offset-2 focus-visible:ring-[3px] disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4"
      >
        <Menu class="h-6 w-6" aria-hidden="true" />
      </button>
    </div>
  </div>

  <!-- Mobile menu -->
  <nav id="mobile-menu" x-show="open" x-transition class="inset-0 z-50 bg-white/95 p-6 backdrop-blur-lg md:hidden">
    <button @click="open = false" aria-label="Fechar menu" class="text-errie-black-900 absolute top-4 right-4">
      <X class="h-4 w-4" aria-hidden="true" />
    </button>
    <ul class="mt-12 flex flex-col gap-6 text-lg font-medium">
      <li><a href="/sobre" class="hover:bg-blood-red-100 text-errie-black-900 block rounded px-4 py-2">Sobre</a></li>
      <li>
        <a href="/projetos" class="hover:bg-blood-red-100 text-errie-black-900 block rounded px-4 py-2">Projetos</a>
      </li>
      <li>
        <a href="/servicos" class="hover:bg-blood-red-100 text-errie-black-900 block rounded px-4 py-2">Serviços</a>
      </li>
      <li><a href="/blog" class="hover:bg-blood-red-100 text-errie-black-900 block rounded px-4 py-2">Blog</a></li>
      <li>
        <a href="/newsletter" class="hover:bg-blood-red-100 text-errie-black-900 block rounded px-4 py-2">Newsletter</a>
      </li>
      <li>
        <a href="/contato" class="hover:bg-blood-red-100 text-errie-black-900 block rounded px-4 py-2">Contato</a>
      </li>
    </ul>
  </nav>
</header>

<style>
  /* Add hover animation to the logo */
  header a:hover svg {
    transform: scale(1.05);
    transition: transform 0.3s ease;
  }

  /* Hide Alpine.js elements before Alpine loads */
  [x-cloak] {
    display: none !important;
  }
</style>
